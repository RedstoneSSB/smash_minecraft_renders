# smash_minecraft_renders
A Rust library and CLI program for creating Minecraft renders for Smash Ultimate using software rendering.

This code was designed for use in [smash-minecraft-skins](https://github.com/jam1garner/smash-minecraft-skins). Users wishing to create their own offline renders should consider using a dedicated 3D modeling and rendering program like Blender for better image quality, depth handling, and lighting effects.

## Overview
Rendering relies on pregenerated input textures with `(U, V, lighting, alpha)` for the RGBA channels. Channel packing improves data locality and reduces the number of costly image sampling operations. The rendering code acts like the final screenspace pixel shader in deferred rendering where inputs are rendered to screenspace textures. This greatly simplifies the implementation but requires careful handling of render order of input images for proper depth sorting.

## Skin Texture Input
The input skin textures are expected to be in the Minecraft Java layout, which is also used for Smash Ultimate. See the included `sample.png` for reference.  

Input textures should be precorrected using the following formula to avoid over exposing the render and more closely match Smash Ultimate's textures.
This is equivalent to a levels adjustment with highlight output set to `184` and midtone output set to `1.386` or `output.rgb = (input.rgb ^ 0.72) * 0.72`.

## Generating Correct Input Images
Lighting maps are generated by dividing the official renders by the texture color in an image editor like Photoshop or Gimp. The final lighting texture requires substantial cleanup due to inaccuracies in matching the texture colors of the original image.

The generated UV map should have vertices snapped to pixel corners and be exported without antialiasing or any sort of dithering to avoid distorting the texture sampling. This can be achieved in Blender by setting view transform to `Raw`, dither to `0.00`, and samples to `1`. See the provided `uvs.png` for the expected dimensions and layout.  

## CLI Usage
`minecraft_render.exe [FLAGS] --skin <sample.png>`  
`minecraft_render.exe -h` for a list of arguments and options.    

Creates the following files:  
```
chara_3_custom.png
chara_4_custom.png
chara_6_custom.png
output.png
```

